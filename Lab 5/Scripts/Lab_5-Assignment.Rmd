---
title: "Biol 3872 Lab5-Assignment"
output: html_document
date: "`r Sys.Date()`"
author: "Ella Cavicchi"
student_id: "B00898234"
---

**BEFORE STARTING:**\
1. Include your name (as shown in Brightspace) in the `author` section above as text (e.g., "Liam MacNeil") and Banner ID ("B00123456") in `student_id`.\
2. Install and load the packages required to run your code chunks/

Assignments will largely be evaluated based on your code chunk answers. If they are incomplete or formatted incorrectly (e.g., code chunks don't run), no marks will be awarded. I recommend experimenting with solving these answers in a separate script/markdown document and reporting your answers with minimal script.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

::: {style="background-color: #44AA99; padding: padding: 5px; border-radius: 2px;"}
## Task 1

A)  Define an object `Euler` containing Euler's number (`exp(1)`). Write an `if` statement which tests if this value is positive and if so, create a new object called `growth` which calculates growth amount of a fish weighing 10 kg (P), at a 5% (0.05) growth rate each year (r), over two years (t).

**Growth equation** = P \* e^r \* t^

```{r}
# YOUR CODE HERE
Euler <- exp(1)
P <- 10
r <- 0.05
t <- 2


if(Euler > 0) {
   growth <- P*(Euler^(r*t))
   }
```
:::

::: {style="background-color: #44AA99; padding: padding: 5px; border-radius: 2px;"}
## Task 2

A)  Define an object `option1` equal to 9, and `option2` equal to 13. Write an explicit `ifelse` statement (not a vectorized version) which tests if one is bigger than the other and if `TRUE`, store this object name in a new variable called `which_max`.

```{r}
# YOUR CODE HERE
option1 <- 9
option2 <- 13

if(option1>option2){
  which_max <- option1
  } else{which_max <- option2
  } 

```
:::

::: {style="background-color: #44AA99; padding: padding: 5px; border-radius: 2px;"}
## Task 3

A)  Using the `marine_survey` data frame, create a column called `environments` using an `ifelse` statement with two conditions: (1) `if` `species_count` is greater than the upper third quantile of `species_count` **and** (*&*) `if` `temperature_c` is greater than the mean temperature, call this row "diverse & hot"- if it's not `TRUE`, call this row "not"

**HINT** You can use a vectorized `ifelse` to achieve this. To grab the upper third quantile, check `?quantile` and the `probs =` argument.

B)  Below I calculate the median value of each numeric column where `environments` are "diverse & hot" and store it in a vector called `diverse_hot_envs`. Fix this code to run properly.

```{r}
# Create a data frame
marine_survey <- data.frame(
  station = c("ST1", "ST2", "ST3", "ST4", "ST5", "ST6"),
  depth_m = c(5, 15, 25, 10, 30, 20),
  temperature_c = c(22.5, 18.3, 12.8, 20.1, 10.5, 15.2),
  salinity_ppt = c(35.2, 35.8, 36.1, 35.5, 36.5, 35.9),
  species_count = c(45, 32, 18, 38, 12, 25)
)

# A) 
# YOUR CODE HERE
marine_survey$environments <- 
  ifelse(marine_survey$species_count > quantile(marine_survey$species_count, probs = 0.75) 
   & marine_survey$temperature_c > mean(marine_survey$temperature_c), 
   yes = "diverse & hot", no = "not")
marine_survey

# B)
# CODE TO FIX

#numeric_columns <- sapply(marine_survey, as.numeric)

#diverse_hot_envs <- sapply(marine_survey[, numeric_columns], function(x) {
 # median(ifelse(marine_survey$environments == "diverse & hot", q, NA), 
  #       na.rm = FALSE)
#})

numeric_columns <- sapply(marine_survey, is.numeric)

numeric_data <- marine_survey[, numeric_columns]

diverse_hot_envs <- sapply(numeric_data, function(x) {
  mean(x[marine_survey$environments == "diverse & hot"], na.rm = TRUE)
})
diverse_hot_envs
```
:::

::: {style="background-color: #44AA99; padding: padding: 5px; border-radius: 2px;"}
## Task 4

A)  Generate a vector called `sheep` of length 100 counting by 1, from 1 to 100.

B)  Write a `for()` loop which multiples all elements of `sheep` by pi and store this in a vector called `counting_sheep`. *Remember you that need an empty vector to fill and that "[]" lets you store elements in vectors*.

```{r}
# YOUR CODE HERE
sheep <- seq(1,100, by=1)


counting_sheep <- c()
for (i in sheep) {
   counting_sheep[i] = sheep[i]*pi
}
counting_sheep

```
:::

::: {style="background-color: #44AA99; padding: padding: 5px; border-radius: 2px;"}
## Task 5

A)  Using the `marine_survey` data frame, use the `lapply` function function to calculate the summary statistics of each numeric column and store this as a `list` called `numeric_summaries`.

B)  Modify the conversion step using `do.call` to flatten this list to a data frame called `numeric_summaries_df`.

C)  Add a column called `variables` using the rownames.

```{r}
#A)
# CODE TO FIX
numeric_summaries <- lapply(marine_survey[sapply(marine_survey, is.numeric)], summary)
numeric_summaries

#B) 
# CODE TO FIX
numeric_summaries_df <- do.call(bind_cols, numeric_summaries)
numeric_summaries_df

# C) 

numeric_summaries_df$variables <- row.names(numeric_summaries_df)
numeric_summaries_df

```
:::

::: {style="background-color: #44AA99; padding: padding: 5px; border-radius: 2px;"}
## Task 6

Rewrite Task 2 in the lecture exercises (summing total abundance for each species, for each year) using group_by() and summarize() instead of a for() loop. Save in an object called `total_abundance`.

```{r}
# Fish abundance data from lecture exercises
fish_abundance <- read.csv("../Data/Groundfish_surveys.csv")

species <- unique(fish_abundance$accepted_name)
year <- unique(fish_abundance$year)

abundance_total <- data.frame(
  species=character(),
  year=numeric(),
  total_cpue=numeric()
)

for (i in species) {
  species_data <- fish_abundance[fish_abundance$accepted_name == i,]
  for (t in year) {
    species_time_data <- species_data[species_data$accepted_name == t,]
    
    total <- sum(species_data$num_cpue, na.rm = TRUE)
    abundance_total <- rbind(abundance_total,
                             data.frame(species=i, year=t, total_cpue=total))
    
  }
}
abundance_total

```

```{r}
# YOUR CODE HERE

total_abundance <- fish_abundance %>% 
  group_by(year, accepted_name) %>% 
  summarise(sum = sum(num_cpue))
total_abundance
```
:::

**BEFORE SUBMITTING**

Clear your environment (broom) and run your entire script to ensure everything has been defined properly!

Be sure to submit this `markdown` file to the relevant Brightspace submission box.
